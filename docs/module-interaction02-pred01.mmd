flowchart BT

WIN["Core Audio<br>(Windows API)"]

subgraph BCK["SoundWinAgent C++ module"]
	LIB["SoundAgentLib::<br>SoundDeviceCollection<br>(C++ class)"]
	APP["<b>SoundWinAgent<br>(C++ Windows Service)</b>"]
	RMQDISP["RabbitMqHttpRequestDispatcher<br>(C++ class)"]

	APP --> |ACCESS device| LIB
	LIB ==> |Device <b>EVENTS</b>| APP

	APP --> |ENQUEUE message requests| RMQDISP
end
style BCK fill:#f6f8fa,stroke:#57606a,color:#24292f

WIN ==> |Device and volume change<br>NOTIFICATIONS| LIB
LIB --> |ACCESS device characteristics| WIN

CHAN[("request queue<br>as RMQ channel")]
FWD["RabbitMQ-To-REST-API-Forwarder<br>(.NET microservice)"]
API["Device Repository Server<br>(REST API)"]

RMQDISP ==> |ENQUEUE message requests| CHAN


CHAN ==> |FETCH message requests| FWD
FWD --> |DETECT message requests| CHAN

FWD ==> |FORWARD message requests| API
